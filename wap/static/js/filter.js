!function(){function e(e,a,o){var n=this;1==o&&(this.pageSetUp.loaded=!1),layer.open({content:"加载中...",skin:"msg",time:1}),$.ajax({url:t+"/carpool/carpool/listCarpool",method:"POST",data:{type:e,page:a},success:function(e){switch(o){case 1:n.dataList=e.data,n.pageSetUp.page++;break;case 2:0==e.data.length&&(n.pageSetUp.loaded=!0,layer.open({content:"没有更多记录了",skin:"msg",time:1})),n.dataList=n.dataList.concat(e.data),n.pageSetUp.page++}}})}var t="",a=new Vue({el:"#filter",data:{filterData:{type:0,from_place:null,to_place:null,mid_place:null,start_time:null,user_count:null,page:1},pageSetUp:{type:0,page:1,loaded:!1},loadActinType:0,dataList:[]},created:function(){var e=this;if("#result"==window.location.hash){layer.open({content:"加载中...",skin:"msg",time:1});var a={};localStorage.getItem("search")&&(a=JSON.parse(localStorage.getItem("search"))),$.ajax({url:t+"/carpool/carpool/listCarpool",method:"POST",data:a,success:function(t){e.dataList=t.data,e.pageSetUp.page++},complete:function(){layer.open({content:"加载完成",skin:"msg",time:1})}})}},computed:{now:function(){return Date.now()/1e3}},methods:{filterAction:function(){localStorage.setItem("search",JSON.stringify(this.filterData)),window.location="filter-result.html#result"},formatTime:function(e,t){var t=t||"yyyy-MM-dd hh:mm",a=new Date;e&&(e=parseInt(e),a.setTime(1e3*e));var o={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in o)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?o[n]:("00"+o[n]).substr((""+o[n]).length)));return t},refreshPage:function(){var t=this.pageSetUp.type,a=this.pageSetUp.page=1,o=this.loadActinType=1;$(window).scrollTop()>50&&$("body, html").animate({scrollTop:0},500,function(){e.call(that,t,a,o)})},calRecentDay:function(e){var t=new Date,a=t.getFullYear(),o=t.getMonth(),n=t.getDate(),l=new Date(a,o,n,0,0,0);l=l.getTime()/1e3;var i=e-l;return i>0&&i<86400?"今":i>86400&&i<172800?"明":void 0}}}),o=_.debounce(function(){var t=this,a=this.pageSetUp.type,o=this.pageSetUp.page,n=2,l=$("body").height(),i=$(window).height(),r=$(window).scrollTop()+i,s=l-r;s<30&&l>i&&!this.pageSetUp.loaded&&e.call(t,a,o,n)},500);$(window).on("scroll",function(){o.call(a)})}();